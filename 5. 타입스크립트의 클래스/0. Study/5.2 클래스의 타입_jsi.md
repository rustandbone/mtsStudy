# 5. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜ í´ë˜ìŠ¤

> ì‘ì„±ì: ì •ì†Œì´, [@uniS2](https://github.com/uniS2)

- [5. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜ í´ë˜ìŠ¤](#5-íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜-í´ë˜ìŠ¤)
  - [5.2 í´ë˜ìŠ¤ì˜ íƒ€ì…](#52-í´ë˜ìŠ¤ì˜-íƒ€ì…)
    - [5.2.1 í´ë˜ìŠ¤ ì„ ì–¸ì€ ì¸ìŠ¤í„´ìŠ¤ì˜ íƒ€ì…ì„ ë§Œë“ ë‹¤](#521-í´ë˜ìŠ¤-ì„ ì–¸ì€-ì¸ìŠ¤í„´ìŠ¤ì˜-íƒ€ì…ì„-ë§Œë“ ë‹¤)
      - [ì¹¼ëŸ¼22 ë³€ìˆ˜ëª…ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ íƒ€ì…ëª…ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤](#ì¹¼ëŸ¼22-ë³€ìˆ˜ëª…ì˜-ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€-íƒ€ì…ëª…ì˜-ë„¤ì„ìŠ¤í˜ì´ìŠ¤)
    - [5.2.2 new ì‹œê·¸ë‹ˆì²˜ë¥¼ ì´ìš©í•œ ì¸ìŠ¤í„´ìŠ¤í™” ê°€ì‹œì„± í‘œí˜„](#522-new-ì‹œê·¸ë‹ˆì²˜ë¥¼-ì´ìš©í•œ-ì¸ìŠ¤í„´ìŠ¤í™”-ê°€ì‹œì„±-í‘œí˜„)
    - [5.2.3 instanceof ì—°ì‚°ìì™€ íƒ€ì… ì¢íˆê¸°](#523-instanceof-ì—°ì‚°ìì™€-íƒ€ì…-ì¢íˆê¸°)

## 5.2 í´ë˜ìŠ¤ì˜ íƒ€ì…

íƒ€ì… ì‹œìŠ¤í…œ ì¸¡ë©´ì—ì„œ ë³´ëŠ” í´ë˜ìŠ¤ ê¸°ëŠ¥ì— ëŒ€í•´ ì•Œ ìˆ˜ ìˆë‹¤.

### 5.2.1 í´ë˜ìŠ¤ ì„ ì–¸ì€ ì¸ìŠ¤í„´ìŠ¤ì˜ íƒ€ì…ì„ ë§Œë“ ë‹¤

ğŸ¤” **í´ë˜ìŠ¤ ì„ ì–¸**

- í´ë˜ìŠ¤ ê°ì²´ë¼ëŠ” ê°’ ìƒì„± + ì¸ìŠ¤í„´ìŠ¤ì˜ íƒ€ì… ì„ ì–¸

```ts
class User {
  name: string = "";
  age: number = 0;

  isAdult(): boolean {
    return this.age >= 20;
  }
}

// ë³€ìˆ˜ uhyoì— Userì˜ ì¸ìŠ¤í„´ìŠ¤
const uhyo = new User();
```

![í´ë˜ìŠ¤ íƒ€ì… ì¶”ë¡ ](/Assets/5.2.1-1.png)

í´ë˜ìŠ¤ ì„ ì–¸ì‹œ Userë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•¨ê³¼ ë™ì‹œì— íƒ€ì…ëª…ìœ¼ë¡œì„œì˜ Userë„ ë³„ë„ë¡œ ìƒì„±ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

```ts
// ë³€ìˆ˜ uhyo íƒ€ì… = new User() íƒ€ì… = User í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤
const uhyo: User = new User();
```

ğŸ˜€ **í´ë˜ìŠ¤ ì„ ì–¸ì˜ íŠ¹ì§•**

- **ì‹¤ì œ í´ë˜ìŠ¤ ê°ì²´** ì™€ **ê·¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í‘œí˜„í•˜ëŠ” íƒ€ì…** ì„ ì„¸íŠ¸ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`new User`ë¡œ ë§Œë“¤ì–´ì§€ì§€ ì•Šì€ ê°ì²´, ì¦‰ í´ë˜ìŠ¤ Userì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ì•„ë‹Œ ê°ì²´ê°€ User íƒ€ì… íŠ¹ì§•ì„ ë§Œì¡±í•œë‹¤ë©´ User íƒ€ì…ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆë‹¤.

```ts
class User {
  name: string = "";
  age: number = 0;

  isAdult(): boolean {
    return this.age >= 20;
  }
}
// ì—¬ê¸°ëŠ” ë‹¹ì—°íˆ OK
const uhyo: User = new User();
// ì—¬ê¸°ë„ User íƒ€ì…ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆë‹¤!
const john: User = {
  name: "John Smith",
  age: 15,
  isAdult: () => true,
};
```

ë‹¤ë§Œ, ì¸ìŠ¤í„´ìŠ¤ë¥¼ í‘œí˜„í•˜ëŠ” íƒ€ì…ì„ ë§Œë“œëŠ” ê²ƒì€ í´ë˜ìŠ¤ ì„ ì–¸ íŠ¹ìœ ì˜ ê¸°ëŠ¥ì´ë¼ í´ë˜ìŠ¤ í‘œí˜„ì‹ì€ ê°™ì€ íš¨ê³¼ë¥¼ ë°œíœ˜í•˜ì§€ ì•ŠëŠ”ë‹¤.

```ts
const User = class {
  name: string = "";
  age: number = 0;

  isAdult(): boolean {
    return this.age >= 20;
  }
};

// ì—¬ê¸°ëŠ” OK
const uhyo = new User();
// ì—ëŸ¬: 'User'ì€(ëŠ”) ê°’ì„ ì°¸ì¡°í•˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤. 'typeof User'ì„(ë¥¼) ì‚¬ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
const john: User = new User();
```

í´ë˜ìŠ¤ê°€ íƒ€ì… ì¸ìˆ˜ë¥¼ ê°€ì§ˆ ê²½ìš° í´ë˜ìŠ¤ ì„ ì–¸ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” íƒ€ì…ë„ ë‹¹ì—°íˆ íƒ€ì… ì¸ìˆ˜ë¥¼ ê°€ì§„ë‹¤.

```ts
class User<T> {
  name: string;
  #age: number;
  readonly data: T;

  constructor(name: string, age: number, data: T) {
    this.name = name;
    this.#age = age;
    this.data = data;
  }
}

const uhyo: User<string> = new User("uhyo", 26, "ì¶”ê°€ ë°ì´í„°");
```

#### ì¹¼ëŸ¼22 ë³€ìˆ˜ëª…ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ íƒ€ì…ëª…ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤

- ì„œë¡œ ë‹¤ë¥¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê°€ì§„ë‹¤. = 'ë…ë¦½ì '

```ts
// íƒ€ì…ëª… ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— Itemì„ ë§Œë“ ë‹¤.
type Item = {
  name: string;
  price: number;
};

// ë³€ìˆ˜ëª… ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— Itemì„ ë§Œë“ ë‹¤.
const Item: Item = {
  name: "ì‚¬ê³¼",
  price: 200,
};

console.log(Item); // ë³€ìˆ˜ëª…
```

- í´ë˜ìŠ¤ ì„ ì–¸ì€ **ë³€ìˆ˜ëª…, íƒ€ì…ëª… ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë™ì‹œì— ì´ë¦„ì„ ë§Œë“ ë‹¤**

```ts
class User {
  name: string = "";
  age: number = 0;
}

const uhyo: User = new User();
```

### 5.2.2 new ì‹œê·¸ë‹ˆì²˜ë¥¼ ì´ìš©í•œ ì¸ìŠ¤í„´ìŠ¤í™” ê°€ì‹œì„± í‘œí˜„

í´ë˜ìŠ¤ ê°ì²´ ìì²´ë¥¼ ë‹¤ë£¨ëŠ” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©ëœë‹¤(ê³  ì•Œì•„ë‘ì!)

- í´ë˜ìŠ¤: í´ë˜ìŠ¤ ê°ì²´ê°€ ë“¤ì–´ê°„ ë³€ìˆ˜
- ì¸ìŠ¤í„´ìŠ¤: new <U>í´ë˜ìŠ¤ ê°ì²´()</U>

ğŸ¤” **í´ë˜ìŠ¤ ê°ì²´ ê·¸ ìì²´ì˜ íƒ€ì…** ì€ ë¬´ì—‡ì¼ê¹Œ?

```ts
class User {
  name: string = "";
  age: number = 0;
}
```

í´ë˜ìŠ¤ ê°ì²´ íƒ€ì… ê¸°ë²•

- í˜¸ì¶œì‹œê·¸ë‹ˆì²˜: new (<U>ì¸ìˆ˜ëª©ë¡</U>) => <U>ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…</U>

  ```ts
  type MyUserConstructor = new () => User;

  // UserëŠ” MyUserConstructor íƒ€ì…
  const MyUser: MyUserConstructor = User;
  // MyUserëŠ” newì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
  const u = new MyUser();
  // uëŠ” User íƒ€ì…
  console.log(u.name, u.age);
  ```

  MyUserConstructor íƒ€ì…: ì¸ìˆ˜ ì—†ì´ newë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆê³  User íƒ€ì… ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ëŠ” ê°ì²´ íƒ€ì…
  = ë³€ìˆ˜ Userì— ë“¤ì–´ìˆëŠ” í´ë˜ìŠ¤ê°€ ë§Œì¡±í•˜ëŠ” ì¡°ê±´

<br/>

- new ì‹œê·¸ë‹ˆì²˜: new (<U>ì¸ìˆ˜ëª©ë¡</U>): <U>ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…</U>
  ```ts
  type MyUserConstructor = {
    new (): User;
  };
  ```

### 5.2.3 instanceof ì—°ì‚°ìì™€ íƒ€ì… ì¢íˆê¸°

ğŸ¤” **instanceof ì—°ì‚°ì**

- ì£¼ì–´ì§„ ê°ì²´ê°€ ì–´ëŠ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ì§€ íŒë‹¨
- í˜•íƒœ: <U>ê°’</U> instanceof <U>í´ë˜ìŠ¤ ê°ì²´</U>

```ts
class User {
  name: string = "";
  age: number = 0;
}

const uhyo = new User();
console.log(uhyo instanceof User); // true
console.log({} instanceof User); // false

const john: User = {
  name: "John Smith",
  age: 15,
};

// johnì€ Userì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ì•„ë‹ˆë¯€ë¡œ false
console.log(john instanceof User);
```

âœ… instanceof ì—°ì‚°ìëŠ” **íƒ€ì… ì¢íˆê¸°(type narrowing)** ì„ ì§€ì›í•œë‹¤.

```ts
type HasAge = {
  age: number;
};

class User {
  name: string;
  age: number;

  constructor(name: string, age: number) {
    this.name = name;
    this.age = age;
  }
}

function getPrice(customer: HasAge) {
  // íƒ€ì… ì¢íˆê¸°: customerëŠ” User íƒ€ì…
  if (customer instanceof User) {
    if (customer.name === "uhyo") {
      return 0;
    }
  }

  // customerëŠ” HasAge íƒ€ì…
  return customer.age < 18 ? 1000 : 1800;
}

const customer1: HasAge = { age: 15 };
const customer2: HasAge = { age: 40 };
const uhyo = new User("uhyo", 26);

console.log(getPrice(customer1)); // 1000ì´ë¼ê³  ì¶œë ¥ëœë‹¤
console.log(getPrice(customer2)); // 1800ì´ë¼ê³  ì¶œë ¥ëœë‹¤
console.log(getPrice(uhyo)); // 0ì´ë¼ê³  ì¶œë ¥ëœë‹¤
```

```ts
// íƒ€ì… ì¢íˆê¸° && ì—°ì‚°ì ì´ìš©
if (customer instanceof User && customer.name === "uhyo") {
  return 0;
}
```

â—í´ë˜ìŠ¤ì— ì˜ì¡´í•œ ë¡œì§ì€ ë°”ëŒì§í•˜ì§€ ì•Šë‹¤. <br/> í´ë˜ìŠ¤ëŠ” **ê°ì²´ íƒ€ì…** ê³¼ **ê·¸ íƒ€ì…ì˜ ê°ì²´ë¥¼ ì„ ì–¸í•˜ëŠ” í¸ë¦¬í•œ ë°©ë²•** ì„ ì œê³µí•˜ê¸° ìœ„í•œ ì¡´ì¬ë‹¤.
